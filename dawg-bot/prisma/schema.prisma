generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                Int      @id @default(autoincrement())
  instagramUsername String   @unique @map("instagram_username")
  createdAt         DateTime @default(now()) @map("created_at")
  
  tags              Tag[]
  reels             Reel[]
  
  @@map("users")
}

model Tag {
  id        Int      @id @default(autoincrement())
  userId    Int      @map("user_id")
  name      String
  createdAt DateTime @default(now()) @map("created_at")
  
  user      User     @relation(fields: [userId], references: [id])
  reels     Reel[]
  
  @@unique([userId, name])
  @@map("tags")
}

model Reel {
  id           Int      @id @default(autoincrement())
  userId       Int      @map("user_id")
  reelUrl      String   @map("reel_url")
  reelMetadata Json?    @map("reel_metadata")
  idea         String
  tagId        Int?     @map("tag_id")
  createdAt    DateTime @default(now()) @map("created_at")
  isDeleted    Boolean  @default(false) @map("is_deleted")
  
  user         User     @relation(fields: [userId], references: [id])
  tag          Tag?     @relation(fields: [tagId], references: [id])
  
  @@index([userId, tagId])
  @@index([userId, isDeleted])
  @@map("reels")
}